# 安全漏洞-高

## 越权查看他人信息

分析：根据关键字进行查询数据，但是未对当前用户进行身份验证。

危害：越权修改查看他人信息。

解决方法：对用户身份进行验证，只允许用户查看自己的信息，查询当前用户数据的条件用户不可控。

服务器要对cookie里的用户信息进行权限校验。不能仅仅靠参数控制，因为参数可以篡改。

## XSS 跨站脚本攻击

Cross-Site Scripting（跨站脚本攻击）简称 XSS，是一种代码注入攻击。攻击者通过在目标网站上注入恶意脚本，使之在用户的浏览器上运行。利用这些恶意脚本，攻击者可获取用户的敏感信息如 Cookie、SessionID 等，进而危害数据安全。

分类：
>以下摘自文章 [前端安全系列（一）：如何防止XSS攻击？](https://www.freebuf.com/articles/web/185654.html)

#### 1. 存储型 XSS


这种攻击常见于带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等。

1. 攻击者将恶意代码提交到目标网站的数据库中。
2. 用户打开目标网站时，网站服务端将恶意代码从数据库取出，拼接在 HTML 中返回给浏览器。
3. 用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。
4. 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。

#### 2. 反射型 XSS
反射型 XSS 的攻击步骤：

1. 攻击者构造出特殊的 URL，其中包含恶意代码。
2. 用户打开带有恶意代码的 URL 时，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器。
3. 用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。
4. 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。

反射型 XSS 跟存储型 XSS 的区别是：存储型 XSS 的恶意代码存在数据库里，反射型 XSS 的恶意代码存在 URL 里。

反射型 XSS 漏洞常见于通过 URL 传递参数的功能，如网站搜索、跳转等。

由于需要用户主动打开恶意的 URL 才能生效，攻击者往往会结合多种手段诱导用户点击。

POST 的内容也可以触发反射型 XSS，只不过其触发条件比较苛刻（需要构造表单提交页面，并引导用户点击），所以非常少见。


#### 3. DOM 型 XSS
DOM 型 XSS 的攻击步骤：

1. 攻击者构造出特殊的 URL，其中包含恶意代码。
2. 用户打开带有恶意代码的 URL。
3. 用户浏览器接收到响应后解析执行，前端 JavaScript 取出 URL 中的恶意代码并执行。
4. 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。

DOM 型 XSS 跟前两种 XSS 的区别：DOM 型 XSS 攻击中，取出和执行恶意代码由浏览器端完成，属于前端 JavaScript 自身的安全漏洞，而其他两种 XSS 都属于服务端的安全漏洞。

示例:

1. 在 HTML 中内嵌的文本中，恶意内容以 script 标签形成注入。
2. 在标签的 href、src 等属性中，包含 javascript: 等可执行代码。

防御：
1. 提交数据的接口，对敏感字符进行转义。
2. 开启模板引擎自带的 HTML 转义功能
4. 避免拼接 HTML
5. 在插入位置为 DOM 属性、链接等位置时，要打起精神，严加防范。

## SQL 注入

分析：mdpre
- 接口报错时抛出SQL语句，方便注入。
- 接口未对查询参数进行过滤

危害：信息泄漏。

解决方法：对参数进行过滤。

## 中间人攻击

在服务器的http/html报文呈现在客户端之前做一些手脚。篡改内容。

主要分两种
1. 在网络报文传输过程中，进行拦截篡改。

  解决方法: 采用https

2. 在客户端发送http之前或收到httpResponse之后对数据进行篡改。

  一般是因为客户端有病毒
